### Как собирать

Для сборки и запуска есть скрипт run.sh, ВАЖНО!!! -- он удаляет все контейнеры и volumes, это нужно для корректного перезапуска с нуля вдальнейшем.

В одном окне запускаем скрипт, в другом после запуска всех целей выполняем docker-compose run pytest
Получим такой результат:
![](./img/Screenshot%202022-04-24%20224800.png)

Можно запускать и нативно, тогда в коде нужно указать полный путь до DATA_DIR и заменить коннекшн до rabbitmq на localhost (помечено комментом # for local tests) 
В отдельных окнах запустим:
1. docker run -it --rm --name rabbitmq -p 5672:5672 -p 15672:15672 rabbitmq:3.9-management
2. python3 server/server.py
3. python3 worker/worker.py
4. cd tests   и затем   pytest -vs

Тогда результат будет такой:
![](./img/Screenshot%202022-04-24%20225803.png)
А в директории data найдём нужный pdf

Ещё можно не собирать всё, а запуллить образы с докерхаба, для в docker-compose.yml достаточно закомментировать всё что связано с build

Вот ссылки на сами образы:
* [hw6_rest_server](https://hub.docker.com/r/kam3nskii/hw6_rest_server)
* [hw6_rest_worker](https://hub.docker.com/r/kam3nskii/hw6_rest_worker)
* [hw6_rest_pytest](https://hub.docker.com/r/kam3nskii/hw6_rest_pytest)

### Как это всё работает

Сервер написан при помощи flask, авторизация при помощи flask-login.
Тестируется при момощи сессий через requests.
Редактировать данные может только авторизованый пользователь, причём только свои.
Получать данные о пользователе могут все кто угодно, как об отдельном, так и о всех сразу.

Картинка передаётся в base64 в json вместе с другими данными, на сервере преобразуется в файл.
При запросе на получение pdf со статистикой, он пренаправляется воркеру через очередь, пользователю сразу же возвращается эндпоинт для последующего скачивания.


У меня не было возможности сделать задание игрой Мафия, поэтому тут для имитации статистики я храню отдельный файл в директории пользователя. Предполагается, что он бы легко заполнялся за счёт прошлога задания.

Рассчитываю на 4 + 6 + 3 = 13 баллов
